import type { DeepDive } from '../../lib/types'

export const reactNormalizationDeepDive: DeepDive = {
  id: 'react-normalization',
  lessonId: 'complexity',
  title: 'React ìƒíƒœ ì •ê·œí™” íŒ¨í„´ (Normalization)',
  content: `
# ğŸ± React ìƒíƒœ ì •ê·œí™”: O(1) íƒìƒ‰ì˜ ì‹¤ë¬´ì  ì ìš©

í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì—ì„œ ëŒ€ê·œëª¨ ë°ì´í„°ë¥¼ ë‹¤ë£° ë•Œ ê°€ì¥ í”í•˜ê²Œ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ ë³‘ëª©ì€ **"ë¶ˆí•„ìš”í•œ ë°°ì—´ ìˆœíšŒ"**ì…ë‹ˆë‹¤. ìˆ˜ë§Œì˜ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ì‹¤ë¬´ í™˜ê²½ì—ì„œ ì–´ë–»ê²Œ ì‹œê°„ë³µì¡ë„ë¥¼ ê´€ë¦¬í•´ì•¼ í• ì§€, ë¦¬ì•¡íŠ¸ ìƒíƒœ ì„¤ê³„ì˜ í•µì‹¬ì¸ **ì •ê·œí™”(Normalization)** íŒ¨í„´ì„ í†µí•´ ê¹Šì´ ìˆê²Œ íŒŒê³ ë“¤ì–´ ë´…ì‹œë‹¤.

---

### 1. ì™œ ì •ê·œí™”ê°€ í•„ìš”í•œê°€? (Problem: O(N) Trap)

ìš°ë¦¬ê°€ APIë¡œë¶€í„° ë°›ëŠ” ì¼ë°˜ì ì¸ ì¤‘ì²©ëœ ë°ì´í„° êµ¬ì¡°ë¥¼ ìƒìƒí•´ ë´…ì‹œë‹¤.

\`\`\`javascript
const posts = [
  { 
    id: 'post1', 
    title: 'Hello', 
    comments: [
      { id: 'c1', content: 'Great!' },
      // ...ìˆ˜ì²œ ê°œì˜ ëŒ“ê¸€
    ] 
  },
  // ...ìˆ˜ë§Œ ê°œì˜ í¬ìŠ¤íŠ¸
]
\`\`\`

ì´ êµ¬ì¡°ì—ì„œ íŠ¹ì • ëŒ“ê¸€ì˜ ë‚´ìš©ì„ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”?
1. ëª¨ë“  í¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•©ë‹ˆë‹¤. (**O(P)**, PëŠ” í¬ìŠ¤íŠ¸ ìˆ˜)
2. ê° í¬ìŠ¤íŠ¸ ë‚´ì˜ ëª¨ë“  ëŒ“ê¸€ì„ ìˆœíšŒí•©ë‹ˆë‹¤. (**O(C)**, CëŠ” ëŒ“ê¸€ ìˆ˜)
3. ëŒ€ìƒ ì•„ì´í…œì„ ì°¾ìœ¼ë©´ ë¶ˆë³€ì„±ì„ ìœ ì§€í•˜ë©° ë¶€ëª¨ë“¤ì„ ëª¨ë‘ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤.

ì´ ì‘ì—…ì˜ ì‹œê°„ë³µì¡ë„ëŠ” í¬ìŠ¤íŠ¸ì™€ ëŒ“ê¸€ ìˆ˜ì˜ ê³±ì— ë¹„ë¡€í•˜ë©°(**O(P * C)**), ë°ì´í„°ê°€ ì»¤ì§ˆìˆ˜ë¡ UIëŠ” ë‘”í•´ì§€ê¸° ì‹œì‘í•©ë‹ˆë‹¤.

---

### 2. ì •ê·œí™”ëœ êµ¬ì¡°: O(1)ìœ¼ë¡œì˜ ì „í™˜

ì •ê·œí™”ëŠ” ì¤‘ì²©ëœ ë°ì´í„°ë¥¼ í‰í‰(Flat)í•˜ê²Œ í´ê³ , ë°ì´í„° ê°„ì˜ ê´€ê³„ë¥¼ IDë¡œ ì°¸ì¡°í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

\`\`\`javascript
{
  posts: {
    byId: {
      'post1': { id: 'post1', title: 'Hello', comments: ['c1', 'c2'] }
    },
    allIds: ['post1']
  },
  comments: {
    byId: {
      'c1': { id: 'c1', content: 'Great!' }
    },
    allIds: ['c1']
  }
}
\`\`\`

#### âœ… ì •ê·œí™”ì˜ ê°•ë ¥í•œ ì¥ì 
- **ì¦‰ì‹œ ì ‘ê·¼**: íŠ¹ì • ì•„ì´í…œì„ ì—…ë°ì´íŠ¸í•  ë•Œ ë£¨í”„ë¥¼ ëŒ í•„ìš” ì—†ì´ \`byId[id]\`ë¥¼ í†µí•´ **O(1)**ë¡œ ì¦‰ì‹œ ì ‘ê·¼í•©ë‹ˆë‹¤.
- **ë°ì´í„° ì¼ê´€ì„±**: ë™ì¼í•œ ë°ì´í„°ê°€ ì—¬ëŸ¬ ê³³ì— ì¡´ì¬í•  ê²½ìš°(ì˜ˆ: ê³µìœ ëœ ìœ ì € í”„ë¡œí•„), í•œ ê³³ë§Œ ì—…ë°ì´íŠ¸í•˜ë©´ ëª¨ë“  ì°¸ì¡°ê°€ ìë™ìœ¼ë¡œ ë™ê¸°í™”ë©ë‹ˆë‹¤.
- **ë Œë”ë§ ìµœì í™”**: íŠ¹ì • í¬ìŠ¤íŠ¸ë‚˜ ëŒ“ê¸€ì´ ë³€ê²½ë˜ì—ˆì„ ë•Œ, í•´ë‹¹ IDë¥¼ êµ¬ë…í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë§Œ ì •ë°€í•˜ê²Œ ë¦¬ë Œë”ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

### 3. ì‹¤ë¬´ êµ¬í˜„ ì „ëµ (Next.js & Zustand/Redux)

í˜„ëŒ€ì ì¸ í”„ë¡ íŠ¸ì—”ë“œ ì•±ì—ì„œëŠ” **ORMê³¼ ìœ ì‚¬í•œ ì ‘ê·¼ ë°©ì‹**ì„ ì·¨í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

#### âŒ (Bad) ë¶€ì£¼ì˜í•œ ì¤‘ì²© ë£¨í”„ íŒ¨í„´
\`\`\`javascript
// ë Œë”ë§ë§ˆë‹¤ O(N) ì—°ì‚° ë°œìƒ
const PostView = ({ postId }) => {
  const post = posts.find(p => p.id === postId); // ë§¤ë²ˆ ìˆœíšŒ!
  return <div>{post.title}</div>
}
\`\`\`

#### âœ… (Good) ì •ê·œí™”ëœ ë£©ì—… íŒ¨í„´
\`\`\`javascript
// O(1) ì§ì ‘ ì ‘ê·¼
const PostView = ({ postId }) => {
  const post = usePostStore(state => state.posts.byId[postId]); // ì¦‰ì‹œ ì°¸ì¡°!
  return <div>{post.title}</div>
}
\`\`\`

---

### ğŸ’¡ ìˆ˜ì„ ì—”ì§€ë‹ˆì–´ì˜ í•œë§ˆë””: ì–¸ì œ ì •ê·œí™”í•´ì•¼ í• ê¹Œ?

ëª¨ë“  ë°ì´í„°ë¥¼ ì •ê·œí™”í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë‹¤ìŒ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„ í•´ë‹¹ëœë‹¤ë©´ ì£¼ì € ì—†ì´ ì •ê·œí™”ë¥¼ ì„ íƒí•˜ì„¸ìš”:

1. **ìƒí˜¸ ì°¸ì¡°ê°€ ë§ì€ ê²½ìš°**: ìœ ì €ê°€ í¬ìŠ¤íŠ¸ì—ë„ ìˆê³  ëŒ“ê¸€ì—ë„ ìˆëŠ” ê²½ìš°.
2. **ë°ì´í„°ì˜ ì–‘ì´ ìˆ˜ì²œ ê°œë¥¼ ë„˜ì–´ê°€ëŠ” ê²½ìš°**: ë Œë”ë§ ì„±ëŠ¥ì´ ì²´ê°ë  ì •ë„ë¡œ ì €í•˜ë  ë•Œ.
3. **ë³µì¡í•œ ì—…ë°ì´íŠ¸ ë¡œì§ì´ í•„ìš”í•œ ê²½ìš°**: ê¹Šì€ ì¤‘ì²© êµ¬ì¡°ì˜ ë°ì´í„°ë¥¼ ë¶ˆë³€ ê°ì²´ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²Œ ê³ í†µìŠ¤ëŸ¬ì›Œì§ˆ ë•Œ.

> **Engineering Tip**: \`Normalize.js\` ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ìµœê·¼ì—ëŠ” \`TanStack Query\`ê°€ ì„œë²„ ìƒíƒœë¥¼ ìºì‹±í•  ë•Œ ë‚´ë¶€ì ìœ¼ë¡œ ìœ ì‚¬í•œ ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ê·¸ ì›ë¦¬ì¸ **"ë°°ì—´ ìˆœíšŒë¥¼ í•´ì‹œ í…Œì´ë¸” ë£©ì—…ìœ¼ë¡œ ì „í™˜í•œë‹¤(O(N) -> O(1))"**ëŠ” ë³¸ì§ˆì„ ì´í•´í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•©ë‹ˆë‹¤.
`,
}
